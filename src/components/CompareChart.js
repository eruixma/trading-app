import React, { Component } from 'react'
import { withRouter } from 'react-router-dom'
import PropTypes from 'prop-types'
import { change } from "react-stockcharts/lib/indicator";
import _ from 'lodash'
import { discontinuousTimeScaleProvider } from 'react-stockcharts/lib/scale'
import { timeFormat, timeParse } from 'd3-time-format'
import { getContext } from 'recompose'
import { Chart, ChartCanvas } from 'react-stockcharts'
import XAxis from 'react-stockcharts/lib/axes/XAxis'
import YAxis from 'react-stockcharts/lib/axes/YAxis'
import { CrossHairCursor, MouseCoordinateX, MouseCoordinateY } from 'react-stockcharts/lib/coordinates'
import { format } from 'd3-format'
import { LineSeries } from 'react-stockcharts/lib/series'
import { fitWidth } from 'react-stockcharts/lib/helper'
import { last } from 'react-stockcharts/lib/utils'

const test_data = [
  {
    "time": "2019-03-19",
    "open": 41.49,
    "high": 41.61,
    "low": 41.31,
    "close": 41.38,
    "volume": 2119529
  },
  {
    "time": "2019-03-18",
    "open": 41.42,
    "high": 41.57,
    "low": 41.31,
    "close": 41.53,
    "volume": 2314934
  },
  {
    "time": "2019-03-15",
    "open": 41.13,
    "high": 41.47,
    "low": 41.13,
    "close": 41.41,
    "volume": 2898178
  },
  {
    "time": "2019-03-14",
    "open": 41.14,
    "high": 41.28,
    "low": 41.02,
    "close": 41.14,
    "volume": 2359268
  },
  {
    "time": "2019-03-13",
    "open": 40.98,
    "high": 41.17,
    "low": 40.91,
    "close": 41.12,
    "volume": 1975720
  },
  {
    "time": "2019-03-12",
    "open": 41,
    "high": 41.13,
    "low": 40.98,
    "close": 41.07,
    "volume": 1232669
  },
  {
    "time": "2019-03-11",
    "open": 40.94,
    "high": 41.07,
    "low": 40.92,
    "close": 41.01,
    "volume": 1770765
  },
  {
    "time": "2019-03-08",
    "open": 40.65,
    "high": 40.91,
    "low": 40.65,
    "close": 40.87,
    "volume": 1631019
  },
  {
    "time": "2019-03-07",
    "open": 40.94,
    "high": 40.965,
    "low": 40.6885,
    "close": 40.87,
    "volume": 2177512
  },
  {
    "time": "2019-03-06",
    "open": 41.08,
    "high": 41.14,
    "low": 40.9241,
    "close": 40.97,
    "volume": 1071511
  },
  {
    "time": "2019-03-05",
    "open": 40.88,
    "high": 41.12,
    "low": 40.81,
    "close": 41,
    "volume": 1678035
  },
  {
    "time": "2019-03-04",
    "open": 40.7,
    "high": 40.79,
    "low": 40.51,
    "close": 40.68,
    "volume": 2050117
  },
  {
    "time": "2019-03-01",
    "open": 40.77,
    "high": 40.945,
    "low": 40.49,
    "close": 40.61,
    "volume": 2006407
  },
  {
    "time": "2019-02-28",
    "open": 40.87,
    "high": 41.15,
    "low": 40.78,
    "close": 40.83,
    "volume": 2357442
  },
  {
    "time": "2019-02-27",
    "open": 40.98,
    "high": 41.19,
    "low": 40.94,
    "close": 41.13,
    "volume": 1823837
  },
  {
    "time": "2019-02-26",
    "open": 40.54,
    "high": 40.845,
    "low": 40.52,
    "close": 40.76,
    "volume": 1667636
  },
  {
    "time": "2019-02-25",
    "open": 40.66,
    "high": 40.76,
    "low": 40.5273,
    "close": 40.59,
    "volume": 1952770
  },
  {
    "time": "2019-02-22",
    "open": 40.72,
    "high": 40.765,
    "low": 40.6,
    "close": 40.71,
    "volume": 1601319
  },
  {
    "time": "2019-02-21",
    "open": 40.95,
    "high": 40.96,
    "low": 40.66,
    "close": 40.81,
    "volume": 2306149
  },
  {
    "time": "2019-02-20",
    "open": 41.84,
    "high": 42.22,
    "low": 41.77,
    "close": 42.13,
    "volume": 3107851
  },
  {
    "time": "2019-02-19",
    "open": 41.16,
    "high": 41.55,
    "low": 40.93,
    "close": 41.52,
    "volume": 6952003
  },
  {
    "time": "2019-02-15",
    "open": 42.79,
    "high": 42.92,
    "low": 42.645,
    "close": 42.8,
    "volume": 1562106
  },
  {
    "time": "2019-02-14",
    "open": 42.24,
    "high": 42.525,
    "low": 42.1275,
    "close": 42.37,
    "volume": 2038656
  },
  {
    "time": "2019-02-13",
    "open": 42.55,
    "high": 42.68,
    "low": 42.295,
    "close": 42.33,
    "volume": 1592385
  },
  {
    "time": "2019-02-12",
    "open": 42.03,
    "high": 42.16,
    "low": 41.97,
    "close": 42.1,
    "volume": 1085815
  },
  {
    "time": "2019-02-11",
    "open": 41.81,
    "high": 41.92,
    "low": 41.65,
    "close": 41.68,
    "volume": 1515942
  },
  {
    "time": "2019-02-08",
    "open": 41.6,
    "high": 41.75,
    "low": 41.46,
    "close": 41.75,
    "volume": 973977
  },
  {
    "time": "2019-02-07",
    "open": 42,
    "high": 42.1,
    "low": 41.61,
    "close": 41.82,
    "volume": 1048233
  },
  {
    "time": "2019-02-06",
    "open": 42.22,
    "high": 42.37,
    "low": 42.045,
    "close": 42.1,
    "volume": 1241972
  },
  {
    "time": "2019-02-05",
    "open": 42.17,
    "high": 42.37,
    "low": 42.0944,
    "close": 42.34,
    "volume": 901948
  },
  {
    "time": "2019-02-04",
    "open": 41.77,
    "high": 41.99,
    "low": 41.72,
    "close": 41.97,
    "volume": 1492506
  },
  {
    "time": "2019-02-01",
    "open": 41.58,
    "high": 41.95,
    "low": 41.53,
    "close": 41.71,
    "volume": 1496688
  },
  {
    "time": "2019-01-31",
    "open": 41.9,
    "high": 42.14,
    "low": 41.775,
    "close": 42.13,
    "volume": 1925694
  },
  {
    "time": "2019-01-30",
    "open": 42.57,
    "high": 42.68,
    "low": 42.32,
    "close": 42.48,
    "volume": 1880048
  },
  {
    "time": "2019-01-29",
    "open": 42.2,
    "high": 42.35,
    "low": 42.035,
    "close": 42.08,
    "volume": 1605247
  },
  {
    "time": "2019-01-28",
    "open": 41.53,
    "high": 41.69,
    "low": 41.44,
    "close": 41.62,
    "volume": 1331524
  },
  {
    "time": "2019-01-25",
    "open": 41.87,
    "high": 42.05,
    "low": 41.7581,
    "close": 41.86,
    "volume": 1606235
  },
  {
    "time": "2019-01-24",
    "open": 41.17,
    "high": 41.47,
    "low": 41.17,
    "close": 41.41,
    "volume": 1410517
  },
  {
    "time": "2019-01-23",
    "open": 41.7,
    "high": 41.745,
    "low": 41.44,
    "close": 41.64,
    "volume": 1219945
  },
  {
    "time": "2019-01-22",
    "open": 41.41,
    "high": 41.57,
    "low": 41.2515,
    "close": 41.38,
    "volume": 2288119
  },
  {
    "time": "2019-01-18",
    "open": 42.04,
    "high": 42.1,
    "low": 41.8,
    "close": 41.92,
    "volume": 1600308
  },
  {
    "time": "2019-01-17",
    "open": 41.15,
    "high": 41.535,
    "low": 41.1401,
    "close": 41.49,
    "volume": 1632850
  },
  {
    "time": "2019-01-16",
    "open": 41.43,
    "high": 41.79,
    "low": 41.4,
    "close": 41.54,
    "volume": 1480486
  },
  {
    "time": "2019-01-15",
    "open": 40.95,
    "high": 41.26,
    "low": 40.81,
    "close": 41.22,
    "volume": 1962618
  },
  {
    "time": "2019-01-14",
    "open": 40.91,
    "high": 41.32,
    "low": 40.89,
    "close": 40.98,
    "volume": 2763001
  },
  {
    "time": "2019-01-11",
    "open": 41.29,
    "high": 41.66,
    "low": 41.21,
    "close": 41.42,
    "volume": 2055921
  },
  {
    "time": "2019-01-10",
    "open": 41.13,
    "high": 41.66,
    "low": 41.1,
    "close": 41.53,
    "volume": 1690624
  },
  {
    "time": "2019-01-09",
    "open": 41.46,
    "high": 41.5735,
    "low": 41.13,
    "close": 41.44,
    "volume": 2733753
  },
  {
    "time": "2019-01-08",
    "open": 41.51,
    "high": 41.57,
    "low": 40.95,
    "close": 41.16,
    "volume": 2888260
  },
  {
    "time": "2019-01-07",
    "open": 41.04,
    "high": 41.26,
    "low": 40.86,
    "close": 41.05,
    "volume": 2212255
  },
  {
    "time": "2019-01-04",
    "open": 41.33,
    "high": 41.85,
    "low": 41.26,
    "close": 41.61,
    "volume": 3061163
  },
  {
    "time": "2019-01-03",
    "open": 40.53,
    "high": 40.77,
    "low": 40.29,
    "close": 40.43,
    "volume": 1479404
  },
  {
    "time": "2019-01-02",
    "open": 40.37,
    "high": 40.905,
    "low": 40.25,
    "close": 40.88,
    "volume": 2565040
  },
  {
    "time": "2018-12-31",
    "open": 41.17,
    "high": 41.41,
    "low": 40.845,
    "close": 41.11,
    "volume": 1719904
  },
  {
    "time": "2018-12-28",
    "open": 41.01,
    "high": 41.345,
    "low": 40.875,
    "close": 41.07,
    "volume": 2190480
  },
  {
    "time": "2018-12-27",
    "open": 40.3,
    "high": 40.7,
    "low": 39.85,
    "close": 40.7,
    "volume": 3242731
  },
  {
    "time": "2018-12-26",
    "open": 40.64,
    "high": 41.23,
    "low": 40.01,
    "close": 41.23,
    "volume": 2421162
  },
  {
    "time": "2018-12-24",
    "open": 40.54,
    "high": 40.88,
    "low": 40.28,
    "close": 40.37,
    "volume": 1771123
  },
  {
    "time": "2018-12-21",
    "open": 40.97,
    "high": 41.45,
    "low": 40.41,
    "close": 40.56,
    "volume": 4191906
  },
  {
    "time": "2018-12-20",
    "open": 41.15,
    "high": 41.285,
    "low": 40.74,
    "close": 40.98,
    "volume": 4317403
  },
  {
    "time": "2018-12-19",
    "open": 41.12,
    "high": 41.39,
    "low": 40.3,
    "close": 40.34,
    "volume": 3763528
  },
  {
    "time": "2018-12-18",
    "open": 41.17,
    "high": 41.28,
    "low": 40.67,
    "close": 40.79,
    "volume": 1923031
  },
  {
    "time": "2018-12-17",
    "open": 40.98,
    "high": 41.07,
    "low": 40.54,
    "close": 40.7,
    "volume": 1964980
  },
  {
    "time": "2018-12-14",
    "open": 40.69,
    "high": 41.09,
    "low": 40.69,
    "close": 40.9,
    "volume": 1246958
  },
  {
    "time": "2018-12-13",
    "open": 41.46,
    "high": 41.56,
    "low": 41.175,
    "close": 41.32,
    "volume": 1969839
  },
  {
    "time": "2018-12-12",
    "open": 41.38,
    "high": 41.77,
    "low": 41.255,
    "close": 41.35,
    "volume": 2489213
  },
  {
    "time": "2018-12-11",
    "open": 40.87,
    "high": 40.91,
    "low": 40.105,
    "close": 40.26,
    "volume": 2524477
  },
  {
    "time": "2018-12-10",
    "open": 40.74,
    "high": 40.86,
    "low": 39.99,
    "close": 40.41,
    "volume": 3089840
  },
  {
    "time": "2018-12-07",
    "open": 41.38,
    "high": 41.645,
    "low": 40.6826,
    "close": 40.85,
    "volume": 2877827
  },
  {
    "time": "2018-12-06",
    "open": 40.8,
    "high": 41.01,
    "low": 39.5801,
    "close": 41.01,
    "volume": 5616368
  },
  {
    "time": "2018-12-04",
    "open": 43.26,
    "high": 43.32,
    "low": 42.33,
    "close": 42.55,
    "volume": 3637059
  },
  {
    "time": "2018-12-03",
    "open": 43.47,
    "high": 43.595,
    "low": 43.275,
    "close": 43.47,
    "volume": 2189182
  },
  {
    "time": "2018-11-30",
    "open": 42.24,
    "high": 42.62,
    "low": 42.21,
    "close": 42.54,
    "volume": 1542037
  },
  {
    "time": "2018-11-29",
    "open": 42.72,
    "high": 42.99,
    "low": 42.69,
    "close": 42.81,
    "volume": 1519557
  },
  {
    "time": "2018-11-28",
    "open": 42.77,
    "high": 43.3199,
    "low": 42.57,
    "close": 43.27,
    "volume": 1936419
  },
  {
    "time": "2018-11-27",
    "open": 42.88,
    "high": 43.035,
    "low": 42.68,
    "close": 42.85,
    "volume": 1571290
  },
  {
    "time": "2018-11-26",
    "open": 43.04,
    "high": 43.28,
    "low": 43.03,
    "close": 43.17,
    "volume": 2172067
  },
  {
    "time": "2018-11-23",
    "open": 41.92,
    "high": 41.94,
    "low": 41.71,
    "close": 41.74,
    "volume": 775619
  },
  {
    "time": "2018-11-21",
    "open": 42.18,
    "high": 42.2835,
    "low": 41.87,
    "close": 41.87,
    "volume": 1519004
  },
  {
    "time": "2018-11-20",
    "open": 41.26,
    "high": 41.39,
    "low": 40.959,
    "close": 41.05,
    "volume": 1539763
  },
  {
    "time": "2018-11-19",
    "open": 42.19,
    "high": 42.24,
    "low": 41.65,
    "close": 41.91,
    "volume": 1588272
  },
  {
    "time": "2018-11-16",
    "open": 41.83,
    "high": 42.28,
    "low": 41.77,
    "close": 42.24,
    "volume": 1909948
  },
  {
    "time": "2018-11-15",
    "open": 41.45,
    "high": 42.42,
    "low": 41.35,
    "close": 42.4,
    "volume": 2151243
  },
  {
    "time": "2018-11-14",
    "open": 42.1,
    "high": 42.101,
    "low": 41.34,
    "close": 41.77,
    "volume": 1899480
  },
  {
    "time": "2018-11-13",
    "open": 41.51,
    "high": 42.0234,
    "low": 41.48,
    "close": 41.79,
    "volume": 2919090
  },
  {
    "time": "2018-11-12",
    "open": 41.24,
    "high": 41.24,
    "low": 40.8025,
    "close": 40.88,
    "volume": 1609572
  },
  {
    "time": "2018-11-09",
    "open": 41.24,
    "high": 41.37,
    "low": 41.07,
    "close": 41.23,
    "volume": 2799200
  },
  {
    "time": "2018-11-08",
    "open": 42.26,
    "high": 42.41,
    "low": 41.79,
    "close": 41.93,
    "volume": 1586592
  },
  {
    "time": "2018-11-07",
    "open": 42.15,
    "high": 42.28,
    "low": 41.83,
    "close": 42.28,
    "volume": 2092022
  },
  {
    "time": "2018-11-06",
    "open": 41.58,
    "high": 41.79,
    "low": 41.53,
    "close": 41.79,
    "volume": 2043037
  },
  {
    "time": "2018-11-05",
    "open": 41.86,
    "high": 42.02,
    "low": 41.52,
    "close": 41.7,
    "volume": 2119548
  },
  {
    "time": "2018-11-02",
    "open": 42.33,
    "high": 42.36,
    "low": 41.73,
    "close": 41.96,
    "volume": 2120454
  },
  {
    "time": "2018-11-01",
    "open": 41.47,
    "high": 41.56,
    "low": 41.325,
    "close": 41.56,
    "volume": 2240534
  },
  {
    "time": "2018-10-31",
    "open": 41.16,
    "high": 41.38,
    "low": 41.07,
    "close": 41.09,
    "volume": 2499429
  },
  {
    "time": "2018-10-30",
    "open": 40.5,
    "high": 40.72,
    "low": 40.345,
    "close": 40.67,
    "volume": 2676153
  },
  {
    "time": "2018-10-29",
    "open": 40.93,
    "high": 41.04,
    "low": 39.94,
    "close": 40.18,
    "volume": 4054451
  },
  {
    "time": "2018-10-26",
    "open": 38.63,
    "high": 38.91,
    "low": 38.234,
    "close": 38.66,
    "volume": 3658912
  },
  {
    "time": "2018-10-25",
    "open": 38.99,
    "high": 39.31,
    "low": 38.855,
    "close": 39.14,
    "volume": 3032662
  },
  {
    "time": "2018-10-24",
    "open": 39.19,
    "high": 39.19,
    "low": 38.54,
    "close": 38.57,
    "volume": 4870812
  },
  {
    "time": "2018-10-23",
    "open": 39.71,
    "high": 39.8,
    "low": 39.26,
    "close": 39.4,
    "volume": 8433196
  }
]
const sp500_daily = {
    "2019-03-20": {
      "1. open": "2831.3401",
      "2. high": "2831.7300",
      "3. low": "2812.4299",
      "4. close": "2818.8000",
      "5. volume": "963900226"
    },
    "2019-03-19": {
      "1. open": "2840.7600",
      "2. high": "2852.4199",
      "3. low": "2823.2700",
      "4. close": "2832.5701",
      "5. volume": "3620220000"
    },
    "2019-03-18": {
      "1. open": "2822.6101",
      "2. high": "2835.4099",
      "3. low": "2821.9900",
      "4. close": "2832.9399",
      "5. volume": "3552190000"
    },
    "2019-03-15": {
      "1. open": "2810.7900",
      "2. high": "2830.7300",
      "3. low": "2810.7900",
      "4. close": "2822.4800",
      "5. volume": "5962730000"
    },
    "2019-03-14": {
      "1. open": "2810.3799",
      "2. high": "2815.0000",
      "3. low": "2803.4600",
      "4. close": "2808.4800",
      "5. volume": "3469730000"
    },
    "2019-03-13": {
      "1. open": "2799.7800",
      "2. high": "2821.2400",
      "3. low": "2799.7800",
      "4. close": "2810.9199",
      "5. volume": "3766150000"
    },
    "2019-03-12": {
      "1. open": "2787.3401",
      "2. high": "2798.3201",
      "3. low": "2786.7300",
      "4. close": "2791.5200",
      "5. volume": "3414230000"
    },
    "2019-03-11": {
      "1. open": "2747.6101",
      "2. high": "2784.0000",
      "3. low": "2747.6101",
      "4. close": "2783.3000",
      "5. volume": "3749030000"
    },
    "2019-03-08": {
      "1. open": "2730.7900",
      "2. high": "2744.1299",
      "3. low": "2722.2700",
      "4. close": "2743.0701",
      "5. volume": "3423130000"
    },
    "2019-03-07": {
      "1. open": "2766.5300",
      "2. high": "2767.2500",
      "3. low": "2739.0901",
      "4. close": "2748.9299",
      "5. volume": "3904860000"
    },
    "2019-03-06": {
      "1. open": "2790.2700",
      "2. high": "2790.2700",
      "3. low": "2768.6899",
      "4. close": "2771.4500",
      "5. volume": "3786600000"
    },
    "2019-03-05": {
      "1. open": "2794.4099",
      "2. high": "2796.4399",
      "3. low": "2782.9700",
      "4. close": "2789.6499",
      "5. volume": "3585690000"
    },
    "2019-03-04": {
      "1. open": "2814.3701",
      "2. high": "2816.8799",
      "3. low": "2767.6599",
      "4. close": "2792.8101",
      "5. volume": "3919810000"
    },
    "2019-03-01": {
      "1. open": "2798.2200",
      "2. high": "2808.0200",
      "3. low": "2787.3799",
      "4. close": "2803.6899",
      "5. volume": "3972280000"
    },
    "2019-02-28": {
      "1. open": "2788.1101",
      "2. high": "2793.7300",
      "3. low": "2782.5100",
      "4. close": "2784.4900",
      "5. volume": "4396930000"
    },
    "2019-02-27": {
      "1. open": "2787.5000",
      "2. high": "2795.7600",
      "3. low": "2775.1299",
      "4. close": "2792.3799",
      "5. volume": "3767130000"
    },
    "2019-02-26": {
      "1. open": "2792.3601",
      "2. high": "2803.1201",
      "3. low": "2789.4700",
      "4. close": "2793.8999",
      "5. volume": "3645680000"
    },
    "2019-02-25": {
      "1. open": "2804.3501",
      "2. high": "2813.4900",
      "3. low": "2794.9900",
      "4. close": "2796.1101",
      "5. volume": "3804380000"
    },
    "2019-02-22": {
      "1. open": "2780.6699",
      "2. high": "2794.2000",
      "3. low": "2779.1101",
      "4. close": "2792.6699",
      "5. volume": "3427810000"
    },
    "2019-02-21": {
      "1. open": "2780.2400",
      "2. high": "2781.5801",
      "3. low": "2764.5500",
      "4. close": "2774.8799",
      "5. volume": "3559710000"
    },
    "2019-02-20": {
      "1. open": "2779.0500",
      "2. high": "2789.8799",
      "3. low": "2774.0601",
      "4. close": "2784.7000",
      "5. volume": "3835450000"
    },
    "2019-02-19": {
      "1. open": "2769.2800",
      "2. high": "2787.3301",
      "3. low": "2767.2900",
      "4. close": "2779.7600",
      "5. volume": "3533710000"
    },
    "2019-02-15": {
      "1. open": "2760.2400",
      "2. high": "2775.6599",
      "3. low": "2760.2400",
      "4. close": "2775.6001",
      "5. volume": "3641370000"
    },
    "2019-02-14": {
      "1. open": "2743.5000",
      "2. high": "2757.8999",
      "3. low": "2731.2300",
      "4. close": "2745.7300",
      "5. volume": "3836700000"
    },
    "2019-02-13": {
      "1. open": "2750.3000",
      "2. high": "2761.8501",
      "3. low": "2748.6299",
      "4. close": "2753.0300",
      "5. volume": "3670770000"
    },
    "2019-02-12": {
      "1. open": "2722.6101",
      "2. high": "2748.1899",
      "3. low": "2722.6101",
      "4. close": "2744.7300",
      "5. volume": "3827770000"
    },
    "2019-02-11": {
      "1. open": "2712.3999",
      "2. high": "2718.0500",
      "3. low": "2703.7900",
      "4. close": "2709.8000",
      "5. volume": "3361970000"
    },
    "2019-02-08": {
      "1. open": "2692.3601",
      "2. high": "2708.0701",
      "3. low": "2681.8301",
      "4. close": "2707.8799",
      "5. volume": "3622330000"
    },
    "2019-02-07": {
      "1. open": "2717.5300",
      "2. high": "2719.3201",
      "3. low": "2687.2600",
      "4. close": "2706.0500",
      "5. volume": "4099490000"
    },
    "2019-02-06": {
      "1. open": "2735.0500",
      "2. high": "2738.0801",
      "3. low": "2724.1499",
      "4. close": "2731.6101",
      "5. volume": "3472690000"
    },
    "2019-02-05": {
      "1. open": "2728.3401",
      "2. high": "2738.9800",
      "3. low": "2724.0300",
      "4. close": "2737.7000",
      "5. volume": "3560430000"
    },
    "2019-02-04": {
      "1. open": "2706.4900",
      "2. high": "2724.9900",
      "3. low": "2698.7500",
      "4. close": "2724.8701",
      "5. volume": "3359840000"
    },
    "2019-02-01": {
      "1. open": "2702.3201",
      "2. high": "2716.6599",
      "3. low": "2696.8799",
      "4. close": "2706.5300",
      "5. volume": "3759270000"
    },
    "2019-01-31": {
      "1. open": "2685.4900",
      "2. high": "2708.9500",
      "3. low": "2678.6499",
      "4. close": "2704.1001",
      "5. volume": "4917650000"
    },
    "2019-01-30": {
      "1. open": "2653.6201",
      "2. high": "2690.4399",
      "3. low": "2648.3401",
      "4. close": "2681.0500",
      "5. volume": "3857810000"
    },
    "2019-01-29": {
      "1. open": "2644.8899",
      "2. high": "2650.9299",
      "3. low": "2631.0500",
      "4. close": "2640.0000",
      "5. volume": "3504200000"
    },
    "2019-01-28": {
      "1. open": "2644.9700",
      "2. high": "2644.9700",
      "3. low": "2624.0601",
      "4. close": "2643.8501",
      "5. volume": "3612810000"
    },
    "2019-01-25": {
      "1. open": "2657.4399",
      "2. high": "2672.3799",
      "3. low": "2657.3301",
      "4. close": "2664.7600",
      "5. volume": "3814080000"
    },
    "2019-01-24": {
      "1. open": "2638.8401",
      "2. high": "2647.2000",
      "3. low": "2627.0100",
      "4. close": "2642.3301",
      "5. volume": "3433250000"
    },
    "2019-01-23": {
      "1. open": "2643.4800",
      "2. high": "2653.1899",
      "3. low": "2612.8601",
      "4. close": "2638.7000",
      "5. volume": "3335610000"
    },
    "2019-01-22": {
      "1. open": "2657.8799",
      "2. high": "2657.8799",
      "3. low": "2617.2700",
      "4. close": "2632.8999",
      "5. volume": "3908030000"
    },
    "2019-01-18": {
      "1. open": "2651.2700",
      "2. high": "2675.4700",
      "3. low": "2647.5801",
      "4. close": "2670.7100",
      "5. volume": "3986730000"
    },
    "2019-01-17": {
      "1. open": "2609.2800",
      "2. high": "2645.0601",
      "3. low": "2606.3601",
      "4. close": "2635.9600",
      "5. volume": "3772270000"
    },
    "2019-01-16": {
      "1. open": "2614.7500",
      "2. high": "2625.7600",
      "3. low": "2612.6799",
      "4. close": "2616.1001",
      "5. volume": "3863770000"
    },
    "2019-01-15": {
      "1. open": "2585.1001",
      "2. high": "2613.0801",
      "3. low": "2585.1001",
      "4. close": "2610.3000",
      "5. volume": "3572330000"
    },
    "2019-01-14": {
      "1. open": "2580.3101",
      "2. high": "2589.3201",
      "3. low": "2570.4099",
      "4. close": "2582.6101",
      "5. volume": "3664450000"
    },
    "2019-01-11": {
      "1. open": "2588.1101",
      "2. high": "2596.2700",
      "3. low": "2577.3999",
      "4. close": "2596.2600",
      "5. volume": "3434490000"
    },
    "2019-01-10": {
      "1. open": "2573.5100",
      "2. high": "2597.8201",
      "3. low": "2562.0200",
      "4. close": "2596.6399",
      "5. volume": "3704500000"
    },
    "2019-01-09": {
      "1. open": "2580.0000",
      "2. high": "2595.3201",
      "3. low": "2568.8899",
      "4. close": "2584.9600",
      "5. volume": "4052480000"
    },
    "2019-01-08": {
      "1. open": "2568.1101",
      "2. high": "2579.8201",
      "3. low": "2547.5601",
      "4. close": "2574.4099",
      "5. volume": "4083030000"
    },
    "2019-01-07": {
      "1. open": "2535.6101",
      "2. high": "2566.1599",
      "3. low": "2524.5601",
      "4. close": "2549.6899",
      "5. volume": "4104710000"
    },
    "2019-01-04": {
      "1. open": "2474.3301",
      "2. high": "2538.0701",
      "3. low": "2474.3301",
      "4. close": "2531.9399",
      "5. volume": "4213410000"
    },
    "2019-01-03": {
      "1. open": "2491.9199",
      "2. high": "2493.1399",
      "3. low": "2443.9600",
      "4. close": "2447.8899",
      "5. volume": "3822860000"
    },
    "2019-01-02": {
      "1. open": "2476.9600",
      "2. high": "2519.4900",
      "3. low": "2467.4700",
      "4. close": "2510.0300",
      "5. volume": "3733160000"
    },
    "2018-12-31": {
      "1. open": "2498.9399",
      "2. high": "2509.2400",
      "3. low": "2482.8201",
      "4. close": "2506.8501",
      "5. volume": "3442870000"
    },
    "2018-12-28": {
      "1. open": "2498.7700",
      "2. high": "2520.2700",
      "3. low": "2472.8899",
      "4. close": "2485.7400",
      "5. volume": "3702620000"
    },
    "2018-12-27": {
      "1. open": "2442.5000",
      "2. high": "2489.1001",
      "3. low": "2397.9399",
      "4. close": "2488.8301",
      "5. volume": "4096610000"
    },
    "2018-12-26": {
      "1. open": "2363.1201",
      "2. high": "2467.7600",
      "3. low": "2346.5801",
      "4. close": "2467.7000",
      "5. volume": "4233990000"
    },
    "2018-12-24": {
      "1. open": "2400.5601",
      "2. high": "2410.3401",
      "3. low": "2351.1001",
      "4. close": "2351.1001",
      "5. volume": "2613930000"
    },
    "2018-12-21": {
      "1. open": "2465.3799",
      "2. high": "2504.4099",
      "3. low": "2408.5500",
      "4. close": "2416.6201",
      "5. volume": "7609010000"
    },
    "2018-12-20": {
      "1. open": "2496.7700",
      "2. high": "2509.6299",
      "3. low": "2441.1799",
      "4. close": "2467.4199",
      "5. volume": "5585780000"
    },
    "2018-12-19": {
      "1. open": "2547.0500",
      "2. high": "2585.2900",
      "3. low": "2488.9600",
      "4. close": "2506.9600",
      "5. volume": "5127940000"
    },
    "2018-12-18": {
      "1. open": "2559.8999",
      "2. high": "2573.9900",
      "3. low": "2528.7100",
      "4. close": "2546.1599",
      "5. volume": "4470880000"
    },
    "2018-12-17": {
      "1. open": "2590.7500",
      "2. high": "2601.1299",
      "3. low": "2530.5400",
      "4. close": "2545.9399",
      "5. volume": "4616350000"
    },
    "2018-12-14": {
      "1. open": "2629.6799",
      "2. high": "2635.0701",
      "3. low": "2593.8401",
      "4. close": "2599.9500",
      "5. volume": "4035020000"
    },
    "2018-12-13": {
      "1. open": "2658.7000",
      "2. high": "2670.1899",
      "3. low": "2637.2700",
      "4. close": "2650.5400",
      "5. volume": "3927720000"
    },
    "2018-12-12": {
      "1. open": "2658.2300",
      "2. high": "2685.4399",
      "3. low": "2650.2600",
      "4. close": "2651.0701",
      "5. volume": "3955890000"
    },
    "2018-12-11": {
      "1. open": "2664.4399",
      "2. high": "2674.3501",
      "3. low": "2621.3000",
      "4. close": "2636.7800",
      "5. volume": "3905870000"
    },
    "2018-12-10": {
      "1. open": "2630.8601",
      "2. high": "2647.5100",
      "3. low": "2583.2300",
      "4. close": "2637.7200",
      "5. volume": "4151030000"
    },
    "2018-12-07": {
      "1. open": "2691.2600",
      "2. high": "2708.5400",
      "3. low": "2623.1399",
      "4. close": "2633.0801",
      "5. volume": "4216690000"
    },
    "2018-12-06": {
      "1. open": "2663.5100",
      "2. high": "2696.1499",
      "3. low": "2621.5300",
      "4. close": "2695.9500",
      "5. volume": "5141470000"
    },
    "2018-12-04": {
      "1. open": "2782.4299",
      "2. high": "2785.9299",
      "3. low": "2697.1799",
      "4. close": "2700.0601",
      "5. volume": "4499840000"
    },
    "2018-12-03": {
      "1. open": "2790.5000",
      "2. high": "2800.1799",
      "3. low": "2773.3799",
      "4. close": "2790.3701",
      "5. volume": "4186060000"
    },
    "2018-11-30": {
      "1. open": "2737.7600",
      "2. high": "2760.8799",
      "3. low": "2732.7600",
      "4. close": "2760.1699",
      "5. volume": "4658580000"
    },
    "2018-11-29": {
      "1. open": "2736.9700",
      "2. high": "2753.7500",
      "3. low": "2722.9399",
      "4. close": "2737.8000",
      "5. volume": "3560770000"
    },
    "2018-11-28": {
      "1. open": "2691.4500",
      "2. high": "2744.0000",
      "3. low": "2684.3799",
      "4. close": "2743.7900",
      "5. volume": "3951670000"
    },
    "2018-11-27": {
      "1. open": "2663.7500",
      "2. high": "2682.5300",
      "3. low": "2655.8899",
      "4. close": "2682.1699",
      "5. volume": "3485220000"
    },
    "2018-11-26": {
      "1. open": "2649.9700",
      "2. high": "2674.3501",
      "3. low": "2649.9700",
      "4. close": "2673.4500",
      "5. volume": "3443950000"
    },
    "2018-11-23": {
      "1. open": "2633.3601",
      "2. high": "2647.5500",
      "3. low": "2631.0901",
      "4. close": "2632.5601",
      "5. volume": "1651650000"
    },
    "2018-11-21": {
      "1. open": "2657.7400",
      "2. high": "2670.7300",
      "3. low": "2649.8201",
      "4. close": "2649.9299",
      "5. volume": "3233550000"
    },
    "2018-11-20": {
      "1. open": "2654.6001",
      "2. high": "2669.4399",
      "3. low": "2631.5200",
      "4. close": "2641.8899",
      "5. volume": "4357900000"
    },
    "2018-11-19": {
      "1. open": "2730.7400",
      "2. high": "2733.1599",
      "3. low": "2681.0901",
      "4. close": "2690.7300",
      "5. volume": "3772900000"
    },
    "2018-11-16": {
      "1. open": "2718.5400",
      "2. high": "2746.7500",
      "3. low": "2712.1599",
      "4. close": "2736.2700",
      "5. volume": "3975180000"
    },
    "2018-11-15": {
      "1. open": "2693.5200",
      "2. high": "2735.3799",
      "3. low": "2670.7500",
      "4. close": "2730.2000",
      "5. volume": "4179140000"
    },
    "2018-11-14": {
      "1. open": "2737.8999",
      "2. high": "2746.8000",
      "3. low": "2685.7500",
      "4. close": "2701.5801",
      "5. volume": "4402370000"
    },
    "2018-11-13": {
      "1. open": "2730.0500",
      "2. high": "2754.6001",
      "3. low": "2714.9800",
      "4. close": "2722.1799",
      "5. volume": "4091440000"
    },
    "2018-11-12": {
      "1. open": "2773.9299",
      "2. high": "2775.9900",
      "3. low": "2722.0000",
      "4. close": "2726.2200",
      "5. volume": "3670930000"
    },
    "2018-11-09": {
      "1. open": "2794.1001",
      "2. high": "2794.1001",
      "3. low": "2764.2400",
      "4. close": "2781.0100",
      "5. volume": "4019090000"
    },
    "2018-11-08": {
      "1. open": "2806.3799",
      "2. high": "2814.7500",
      "3. low": "2794.9900",
      "4. close": "2806.8301",
      "5. volume": "3630490000"
    },
    "2018-11-07": {
      "1. open": "2774.1299",
      "2. high": "2815.1499",
      "3. low": "2774.1299",
      "4. close": "2813.8899",
      "5. volume": "3914750000"
    },
    "2018-11-06": {
      "1. open": "2738.3999",
      "2. high": "2756.8201",
      "3. low": "2737.0801",
      "4. close": "2755.4500",
      "5. volume": "3510860000"
    },
    "2018-11-05": {
      "1. open": "2726.3701",
      "2. high": "2744.2700",
      "3. low": "2717.9399",
      "4. close": "2738.3101",
      "5. volume": "3623320000"
    },
    "2018-11-02": {
      "1. open": "2745.4500",
      "2. high": "2756.5500",
      "3. low": "2700.4399",
      "4. close": "2723.0601",
      "5. volume": "4237930000"
    },
    "2018-11-01": {
      "1. open": "2717.5801",
      "2. high": "2741.6699",
      "3. low": "2708.8501",
      "4. close": "2740.3701",
      "5. volume": "4708420000"
    },
    "2018-10-31": {
      "1. open": "2705.6001",
      "2. high": "2736.6899",
      "3. low": "2705.6001",
      "4. close": "2711.7400",
      "5. volume": "5112420000"
    },
    "2018-10-30": {
      "1. open": "2640.6799",
      "2. high": "2685.4299",
      "3. low": "2635.3401",
      "4. close": "2682.6299",
      "5. volume": "5106380000"
    },
    "2018-10-29": {
      "1. open": "2682.6499",
      "2. high": "2706.8501",
      "3. low": "2603.5400",
      "4. close": "2641.2500",
      "5. volume": "4673700000"
    },
    "2018-10-26": {
      "1. open": "2667.8601",
      "2. high": "2692.3799",
      "3. low": "2628.1599",
      "4. close": "2658.6899",
      "5. volume": "4803150000"
    },
    "2018-10-25": {
      "1. open": "2674.8799",
      "2. high": "2722.7000",
      "3. low": "2667.8401",
      "4. close": "2705.5701",
      "5. volume": "4634770000"
    },
    "2018-10-24": {
      "1. open": "2737.8701",
      "2. high": "2742.5901",
      "3. low": "2651.8899",
      "4. close": "2656.1001",
      "5. volume": "4709310000"
    }
  }


class CompareChart extends Component {
  render() {

    let SP = Object.keys(sp500_daily).map(k=>({
      time: k,
      open: sp500_daily[k]['1. open'],
      high: sp500_daily[k]['2. high'],
      low: sp500_daily[k]['3. low'],
      close: sp500_daily[k]['4. close'],
      volume: sp500_daily[k]['5. volume'],
    }))


    const xScaleProvider = discontinuousTimeScaleProvider.inputDateAccessor(d => d.date)
    let changeRate = change().id(23).accessor(d => d.change);
    let calculatedData = changeRate(test_data.map(ts => ({
      ...ts,
      date: timeParse("%Y-%m-%d")(ts.time)
    })))
    let calculatedSP500Data = changeRate(SP.map(ts => ({
      ...ts,
      date: timeParse("%Y-%m-%d")(ts.time)
    })))
    const {data} = xScaleProvider(_.sortBy(calculatedData, ['date']))
    const {data: spchange} = xScaleProvider(_.sortBy(calculatedSP500Data, ['date']))
    console.log(data)
    let compareData = data.map((d, i)=>({...d, spChange: spchange[i].percentChange}))
    console.log(compareData)

    const {data:finalData, xScale, xAccessor, displayXAccessor} = xScaleProvider(_.sortBy(compareData, ['date']))
    const xExtents = [
      xAccessor(last(finalData)),
      xAccessor(finalData[0])
    ];
    return (
        <ChartCanvas ratio={this.props.ratio}
                     width={this.props.width}
                     height={260}
                     pointsPerPxThreshold={1}
                     margin={{ left: 70, right: 70, top: 0, bottom: 30 }}
                     seriesName={'sp'}
                     data={finalData}
                     xAccessor={xAccessor}
                     displayXAccessor={displayXAccessor}
                     xScale={xScale}
                     xExtents={xExtents}>
          <Chart id={1} yExtents={d => [d.percentChange/100]}>
            <XAxis axisAt="bottom" orient="bottom" stroke={'#f2f2f2'} tickStroke={'#f2f2f2'}/>
            <YAxis axisAt="left" orient="left" ticks={20} tickFormat={format(".0%")} stroke={'#f2f2f2'} tickStroke={'#f2f2f2'}/>
            <MouseCoordinateX
              at="bottom"
              orient="bottom"
              displayFormat={timeFormat("%Y-%m-%d")} />
            <MouseCoordinateY
              at="right"
              orient="right"
              displayFormat={format(",.2f")} />

            <LineSeries
              yAccessor={d => d.percentChange/100}
              strokeWidth={2}
              hoverStrokeWidth={4}
              highlightOnHover

              stroke="#288964"/>
            <LineSeries
              yAccessor={d => d.spChange/100}
              strokeWidth={2}
              hoverStrokeWidth={4}
              highlightOnHover

              stroke="#dcaf00"/>
          </Chart>

          <CrossHairCursor stroke={'#f2f2f2'}/>
        </ChartCanvas>
    )
  }
}

CompareChart = fitWidth(CompareChart)

export default getContext({
  store: PropTypes.object,
  actions: PropTypes.object,
})(withRouter(CompareChart))
